<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{/layout/layout_admin :: main-fragment(
                                                ~{:: title},
                                                'header',
                                                'sidebar',
                                                ~{:: #css-resources},
                                                ~{:: #js-resources},
                                                ~{:: #main-content}
                                               )}">
<head>
    <title>Trang quản trị </title>
    <th:block id="css-resources">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.css">
        <style>
            #barChart {
                display: block;
                box-sizing: border-box;
                height: 411px !important;
                width: 411px !important;
                margin: auto;
            }

            #doughnutBrand {
                display: block;
                box-sizing: border-box;
                height: 411px !important;
                width: 411px !important;
                margin: auto;
            }

            #myChartProduct {
                display: block;
                box-sizing: border-box;
                height: 409px !important;
                width: 775px;
            }
        </style>
    </th:block>
</head>
<body>
<section role="main" class="content-body" id="main-content">
    <header class="page-header">
        <div class="right-wrapper text-right">
            <ol class="breadcrumbs">
                <li>
                    <a href="/admin">
                        <i class="bx bx-home-alt"></i>
                    </a>
                </li>
            </ol>
            <a class="sidebar-right-toggle" data-open="sidebar-right"><i
                    class="fas fa-chevron-left"></i></a>
        </div>
    </header>
    <div class="row">
        <div class="col-lg-12">
            <div class="row mb-3">
                <div class="col-xl-4">
                    <section class="card card-featured-left card-featured-primary mb-3">
                        <div class="card-body">
                            <div class="widget-summary">
                                <div class="widget-summary-col widget-summary-col-icon">
                                    <div class="summary-icon bg-primary">
                                        <i class="fas fa-life-ring"></i>
                                    </div>
                                </div>
                                <div class="widget-summary-col">
                                    <div class="summary">
                                        <h4 class="title">Số lượng sản phẩm</h4>
                                        <div class="info">
                                            <strong class="amount" id="product-count"></strong>
                                        </div>
                                    </div>
                                    <div class="summary-footer">
                                        <a class="text-muted text-uppercase" href="/admin/products">(Xem chi tiết)</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <div class="col-xl-4">
                    <section class="card card-featured-left card-featured-secondary">
                        <div class="card-body">
                            <div class="widget-summary">
                                <div class="widget-summary-col widget-summary-col-icon">
                                    <div class="summary-icon bg-warning">
                                        <i class="fas fa-certificate"></i>
                                    </div>
                                </div>
                                <div class="widget-summary-col">
                                    <div class="summary">
                                        <h4 class="title">Tổng số danh mục</h4>
                                        <div class="info">
                                            <strong class="amount" id="category-count"></strong>
                                        </div>
                                    </div>
                                    <div class="summary-footer">
                                        <a class="text-muted text-uppercase" href="/admin/categories">(Xem chi tiết)</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <div class="col-xl-4">
                    <section class="card card-featured-left card-featured-tertiary mb-3">
                        <div class="card-body">
                            <div class="widget-summary">
                                <div class="widget-summary-col widget-summary-col-icon">
                                    <div class="summary-icon bg-secondary">
                                        <i class="fas fa-shopping-cart"></i>
                                    </div>
                                </div>
                                <div class="widget-summary-col">
                                    <div class="summary">
                                        <h4 class="title">Tổng số đơn hàng</h4>
                                        <div class="info">
                                            <strong class="amount" id="order-count"></strong>
                                        </div>
                                    </div>
                                    <div class="summary-footer">
                                        <a class="text-muted text-uppercase" href="/admin/orders">(Xem chi tiết)</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
            <div class="row mb-3">

                <div class="col-xl-4">
                    <section class="card card-featured-left card-featured-quaternary">
                        <div class="card-body">
                            <div class="widget-summary">
                                <div class="widget-summary-col widget-summary-col-icon">
                                    <div class="summary-icon bg-info">
                                        <i class="fas fa-bookmark"></i>
                                    </div>
                                </div>
                                <div class="widget-summary-col">
                                    <div class="summary">
                                        <h4 class="title">Tổng số nhãn hiệu</h4>
                                        <div class="info">
                                            <strong class="amount" id="brands-count"></strong>
                                        </div>
                                    </div>
                                    <div class="summary-footer">
                                        <a class="text-muted text-uppercase" href="/admin/brands">(Xem chi tiết)</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <div class="col-xl-4">
                    <section class="card card-featured-left card-featured-tertiary mb-3">
                        <div class="card-body">
                            <div class="widget-summary">
                                <div class="widget-summary-col widget-summary-col-icon">
                                    <div class="summary-icon bg-danger">
                                        <i class="fas fa-user-injured"></i>
                                    </div>
                                </div>
                                <div class="widget-summary-col">
                                    <div class="summary">
                                        <h4 class="title">Tổng số user</h4>
                                        <div class="info">
                                            <strong class="amount" id="countUser"></strong>
                                        </div>
                                    </div>
                                    <div class="summary-footer">
                                        <a class="text-muted text-uppercase" href="/admin/users">(Xem chi tiết)</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>

<th:block id="js-resources">
    <script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.min.js"></script>
    <script th:src="@{https://cdn.jsdelivr.net/npm/chart.js@3.1.0/dist/chart.min.js}"></script>
<!--    <script>-->

<!--        getListProductOrderedByCategory();-->
<!--        getListProductOrderedByBrand();-->
<!--        getListProductOrder();-->

<!--        function getListProductOrderedByCategory() {-->
<!--            $.ajax({-->
<!--                url: '/api/admin/product-order-categories',-->
<!--                type: 'GET',-->
<!--                contentType: 'application/json',-->
<!--                success: function (res) {-->
<!--                    let data_get = res;-->
<!--                    for (var i = 0; i < data_get.length; i++) {-->
<!--                        dataChartProductOrderedByCategory.push(data_get[i].value);-->
<!--                        labelChartProductOrderedByCategory.push(data_get[i].label);-->
<!--                    }-->
<!--                    if ($("#barChart").length) {-->
<!--                        var barChartCanvas = $("#barChart").get(0).getContext("2d");-->
<!--                        // This will get the first returned node in the jQuery collection.-->
<!--                        var barChart = new Chart(barChartCanvas, {-->
<!--                            type: 'polarArea',-->
<!--                            data: data,-->
<!--                            options: doughnutPieOptions-->
<!--                        });-->
<!--                    }-->
<!--                }-->
<!--            })-->
<!--        }-->

<!--        -->

<!--        let doughnutPieOptions = {-->
<!--            responsive: true,-->
<!--            animation: {-->
<!--                animateScale: true,-->
<!--                animateRotate: true-->
<!--            }-->
<!--        };-->

<!--        function getListProductOrderedByBrand() {-->
<!--            $.ajax({-->
<!--                url: '/api/admin/product-order-brands',-->
<!--                type: 'GET',-->
<!--                contentType: 'application/json',-->
<!--                success: function (res) {-->
<!--                    let data_get = res;-->
<!--                    for (var i = 0; i < data_get.length; i++) {-->
<!--                        dataChartProductOrderedByBrand.push(data_get[i].value);-->
<!--                        labelChartProductOrderedByBrand.push(data_get[i].label);-->
<!--                    }-->
<!--                    if ($("#doughnutBrand").length) {-->
<!--                        var barChartCanvasBrand = $("#doughnutBrand").get(0).getContext("2d");-->
<!--                        // This will get the first returned node in the jQuery collection.-->
<!--                        var barChart = new Chart(barChartCanvasBrand, {-->
<!--                            type: 'polarArea',-->
<!--                            data: dataBrand,-->
<!--                            options: doughnutPieOptionsBrand-->
<!--                        });-->
<!--                    }-->
<!--                }-->
<!--            })-->
<!--        }-->


<!--        let doughnutPieOptionsBrand = {-->
<!--            responsive: true,-->
<!--            animation: {-->
<!--                animateScale: true,-->
<!--                animateRotate: true-->
<!--            }-->
<!--        };-->

<!--        function getListProductOrder() {-->
<!--            $.ajax({-->
<!--                url: '/api/admin/product-order',-->
<!--                type: 'GET',-->
<!--                contentType: 'application/json',-->
<!--                success: function (res) {-->
<!--                    let data_get = res;-->
<!--                    for (var i = 0; i < data_get.length; i++) {-->
<!--                        dataChartProductOrdered.push(data_get[i].value);-->
<!--                        labelChartProductOrdered.push(data_get[i].label);-->
<!--                    }-->
<!--                    if ($("#myChartProduct").length) {-->
<!--                        var barChartCanvasProduct = $("#myChartProduct").get(0).getContext("2d");-->
<!--                        // This will get the first returned node in the jQuery collection.-->
<!--                        var barChart = new Chart(barChartCanvasProduct, {-->
<!--                            type: 'bar',-->
<!--                            data: dataProduct,-->
<!--                            options: doughnutPieOptionsProduct-->
<!--                        });-->
<!--                    }-->
<!--                }-->
<!--            })-->
<!--        }-->



<!--        let doughnutPieOptionsProduct = {-->
<!--            responsive: true,-->
<!--            animation: {-->
<!--                animateScale: true,-->
<!--                animateRotate: true-->
<!--            }-->
<!--        };-->
<!--    </script>-->
    <script>


        function init() {
            getCountCategory();
            getCountProduct();
            getCountOrder();
            getCountBrands();
            getCountUsers();
        }

        function getCountUsers() {
            $.ajax({
                url: '/api/admin/count/users',
                type: 'GET',
                contentType: 'application/json',
                success: function (data) {
                    $('#countUser').append(`
                        <strong>${data}</strong>
                    `)
                }
            })
        }

        function getCountCategory() {
            $.ajax({
                url: '/api/admin/count/categories',
                type: 'GET',
                contentType: 'application/json',
                success: function (data) {
                    $('#category-count').append(`
                        <strong>${data}</strong>
                    `)
                }
            })
        }

        function getCountProduct() {
            $.ajax({
                url: '/api/admin/count/products',
                type: 'GET',
                contentType: 'application/json',
                success: function (data) {
                    $('#product-count').append(`
                        <strong>${data}</strong>
                    `)
                }
            })
        }

        function getCountOrder() {
            $.ajax({
                url: '/api/admin/count/orders',
                type: 'GET',
                contentType: 'application/json',
                success: function (data) {
                    $('#order-count').append(`
                        <strong>${data}</strong>
                    `)
                }
            })
        }



        function getCountBrands() {
            $.ajax({
                url: '/api/admin/count/brands',
                type: 'GET',
                contentType: 'application/json',
                success: function (data) {
                    $('#brands-count').append(`
                        <strong>${data}</strong>
                    `)
                }
            })
        }

        init();
    </script>
</th:block>

</body>
</html>